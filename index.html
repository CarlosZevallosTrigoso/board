<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Notas</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono&display=swap" rel="stylesheet">
    <style>
        :root { --background-color: #ffffff; --text-color: #000000; }
        body { 
            background-color: var(--background-color); 
            color: var(--text-color); 
            font-family: 'Roboto Mono', monospace; 
            font-size: 16px; 
            line-height: 1.5; 
            margin: 0; 
            padding: 10vh 20px 20px 20px; /* Padding por defecto para móviles */
            box-sizing: border-box; 
        }
        .terminal-container { 
            width: 100%; 
            max-width: 800px; 
            margin: 0; 
        }
        h1 {
            font-size: 1em; 
            font-weight: normal; 
            margin-bottom: 1.5em;
            padding-bottom: 0.5em;
        }
        #messages-container { word-break: break-word; }
        .message { 
            margin-bottom: 1em; 
        }
        .message .timestamp { margin-right: 15px; opacity: 0.7; }

        /* Estilos para pantallas de escritorio (más de 768px de ancho) */
        @media (min-width: 768px) {
            body {
                padding-left: 20vw; /* Mueve el contenido 20% a la derecha */
            }
        }
    </style>
</head>
<body>
    <div class="terminal-container">
        <h1>Notas</h1>
        <div id="messages-container">Cargando entradas...</div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getFirestore, collection, query, onSnapshot, orderBy } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        const firebaseConfig = {
          apiKey: "AIzaSyCeQVpJTYM0UtRPmy4S8R38FYtl_b2ThzQ",
          authDomain: "mi-terminal-czt.firebaseapp.com",
          projectId: "mi-terminal-czt",
          storageBucket: "mi-terminal-czt.appspot.com",
          messagingSenderId: "979923860891",
          appId: "1:979923860891:web:56ae8c88bd65cea9a5b53e"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const messagesContainer = document.getElementById('messages-container');

        function loadMessages() {
            const q = query(collection(db, "messages"), orderBy("createdAt", "desc"));
            
            onSnapshot(q, (querySnapshot) => {
                messagesContainer.innerHTML = '';
                if (querySnapshot.empty) {
                    messagesContainer.textContent = "No hay entradas en el sistema.";
                }
                querySnapshot.forEach((doc) => {
                    const messageData = doc.data();
                    const messageElement = document.createElement('div');
                    messageElement.classList.add('message');
                    
                    const date = messageData.createdAt.toDate();
                    const formattedDate = `${date.getFullYear()}-${(date.getMonth()+1).toString().padStart(2, '0')}-${date.getDate().toString().padStart(2, '0')}`;
                    const formattedTime = `${date.getHours().toString().padStart(2, '0')}:${date.getMinutes().toString().padStart(2, '0')}`;

                    messageElement.innerHTML = `<span class="timestamp">[${formattedDate} ${formattedTime}]</span><span class="text">${messageData.text}</span>`;
                    messagesContainer.appendChild(messageElement);
                });
            });
        }
        
        loadMessages();
    </script>
</body>
</html>
